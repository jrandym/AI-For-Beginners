# 합성곱 신경망

우리는 이전에 신경망이 이미지 처리에 매우 능숙하다는 것을 보았으며, 단일 층 퍼셉트론조차도 MNIST 데이터셋에서 손으로 쓴 숫자를 합리적인 정확도로 인식할 수 있습니다. 그러나 MNIST 데이터셋은 매우 특별하며, 모든 숫자가 이미지 안에 중앙에 위치해 있어 작업이 더 간단해집니다.

## [강의 전 퀴즈](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/107)

실제 상황에서는 이미지 내에서 객체의 정확한 위치에 관계없이 객체를 인식할 수 있어야 합니다. 컴퓨터 비전은 일반적인 분류와는 다릅니다. 왜냐하면 우리가 사진에서 특정 객체를 찾으려고 할 때, 우리는 이미지에서 특정 **패턴**과 그 조합을 찾기 위해 스캔하고 있기 때문입니다. 예를 들어, 고양이를 찾을 때 우리는 먼저 수염을 형성할 수 있는 수평선을 찾을 수 있으며, 그런 다음 특정 수염의 조합이 실제로 고양이의 사진임을 알려줄 수 있습니다. 특정 패턴의 상대적 위치와 존재는 중요하며, 이미지에서의 정확한 위치는 중요하지 않습니다.

패턴을 추출하기 위해 우리는 **합성곱 필터**의 개념을 사용할 것입니다. 아시다시피, 이미지는 2D 매트릭스 또는 색 깊이를 가진 3D 텐서로 표현됩니다. 필터를 적용한다는 것은 상대적으로 작은 **필터 커널** 매트릭스를 사용하여 원본 이미지의 각 픽셀에 대해 이웃 점들과의 가중 평균을 계산하는 것을 의미합니다. 우리는 이것을 전체 이미지 위를 슬라이딩하는 작은 창으로 보고, 필터 커널 매트릭스의 가중치에 따라 모든 픽셀을 평균화할 수 있습니다.

![수직 엣지 필터](../../../../../translated_images/filter-vert.b7148390ca0bc356ddc7e55555d2481819c1e86ddde9dce4db5e71a69d6f887f.ko.png) | ![수평 엣지 필터](../../../../../translated_images/filter-horiz.59b80ed4feb946efbe201a7fe3ca95abb3364e266e6fd90820cb893b4d3a6dda.ko.png)
----|----

> 이미지 제공: Dmitry Soshnikov

예를 들어, MNIST 숫자에 3x3 수직 엣지 및 수평 엣지 필터를 적용하면 원본 이미지에서 수직 및 수평 엣지가 있는 곳에서 하이라이트(예: 높은 값)를 얻을 수 있습니다. 따라서 이 두 필터는 엣지를 "찾기 위해" 사용될 수 있습니다. 마찬가지로, 우리는 다른 저수준 패턴을 찾기 위해 다양한 필터를 설계할 수 있습니다.

> [Leung-Malik 필터 뱅크](https://www.robots.ox.ac.uk/~vgg/research/texclass/filters.html) 이미지

하지만 패턴을 수동으로 추출하기 위해 필터를 설계할 수 있는 것 외에도, 네트워크가 자동으로 패턴을 학습하도록 설계할 수도 있습니다. 이것이 CNN의 주요 아이디어 중 하나입니다.

## CNN의 주요 아이디어

CNN이 작동하는 방식은 다음과 같은 중요한 아이디어에 기반합니다:

* 합성곱 필터는 패턴을 추출할 수 있습니다.
* 필터가 자동으로 학습되도록 네트워크를 설계할 수 있습니다.
* 우리는 원본 이미지뿐만 아니라 고수준 특징에서도 패턴을 찾기 위해 동일한 접근 방식을 사용할 수 있습니다. 따라서 CNN의 특징 추출은 저수준 픽셀 조합에서 시작하여 이미지 부분의 고수준 조합에 이르는 특징의 계층 구조에서 작동합니다.

![계층적 특징 추출](../../../../../translated_images/FeatureExtractionCNN.d9b456cbdae7cb643fde3032b81b2940e3cf8be842e29afac3f482725ba7f95c.ko.png)

> [Hislop-Lynch의 논문](https://www.semanticscholar.org/paper/Computer-vision-based-pedestrian-trajectory-Hislop-Lynch/26e6f74853fc9bbb7487b06dc2cf095d36c9021d)에서 제공된 이미지, [그들의 연구](https://dl.acm.org/doi/abs/10.1145/1553374.1553453)를 기반으로 합니다.

## ✍️ 연습: 합성곱 신경망

합성곱 신경망이 어떻게 작동하는지, 그리고 어떻게 학습 가능한 필터를 얻을 수 있는지 탐구를 계속해 봅시다. 해당 노트북을 통해 진행해 보세요:

* [합성곱 신경망 - PyTorch](../../../../../lessons/4-ComputerVision/07-ConvNets/ConvNetsPyTorch.ipynb)
* [합성곱 신경망 - TensorFlow](../../../../../lessons/4-ComputerVision/07-ConvNets/ConvNetsTF.ipynb)

## 피라미드 아키텍처

이미지 처리를 위해 사용되는 대부분의 CNN은 이른바 피라미드 아키텍처를 따릅니다. 원본 이미지에 적용되는 첫 번째 합성곱 층은 일반적으로 상대적으로 낮은 수의 필터(8-16)를 가지며, 이는 수평/수직 선과 같은 다양한 픽셀 조합에 해당합니다. 다음 단계에서는 네트워크의 공간 차원을 줄이고 필터의 수를 늘리며, 이는 더 많은 간단한 특징 조합에 해당합니다. 각 레이어마다 최종 분류기로 이동할수록 이미지의 공간 차원은 줄어들고 필터의 수는 증가합니다.

예를 들어, 2014년 ImageNet의 top-5 분류에서 92.7% 정확도를 달성한 VGG-16 아키텍처를 살펴보겠습니다:

![ImageNet 레이어](../../../../../translated_images/vgg-16-arch1.d901a5583b3a51baeaab3e768567d921e5d54befa46e1e642616c5458c934028.ko.jpg)

![ImageNet 피라미드](../../../../../translated_images/vgg-16-arch.64ff2137f50dd49fdaa786e3f3a975b3f22615efd13efb19c5d22f12e01451a1.ko.jpg)

> [Researchgate](https://www.researchgate.net/figure/Vgg16-model-structure-To-get-the-VGG-NIN-model-we-replace-the-2-nd-4-th-6-th-7-th_fig2_335194493)에서 제공된 이미지

## 잘 알려진 CNN 아키텍처

[잘 알려진 CNN 아키텍처에 대한 학습을 계속하세요](CNN_Architectures.md)

**면책 조항**:  
이 문서는 기계 기반 AI 번역 서비스를 사용하여 번역되었습니다. 정확성을 위해 노력하고 있지만, 자동 번역에는 오류나 부정확성이 포함될 수 있습니다. 원본 문서는 해당 언어로 작성된 권위 있는 출처로 간주되어야 합니다. 중요한 정보에 대해서는 전문적인 인간 번역을 권장합니다. 이 번역을 사용하여 발생하는 오해나 잘못된 해석에 대해 우리는 책임을 지지 않습니다.