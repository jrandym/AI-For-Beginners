# 知識表現とエキスパートシステム

![Symbolic AIコンテンツの概要](../../../../translated_images/ai-symbolic.715a30cb610411a6964d2e2f23f24364cb338a07cb4844c1f97084d366e586c3.ja.png)

> スケッチノート by [Tomomi Imura](https://twitter.com/girlie_mac)

人工知能の探求は、世界を人間と同じように理解するための知識の探索に基づいています。しかし、どのようにしてこれを実現するのでしょうか？

## [事前講義クイズ](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/102)

AIの初期の頃、知能システムを作成するためのトップダウンアプローチ（前のレッスンで議論されたもの）が人気でした。この考え方は、人々から知識を抽出し、機械が読み取れる形式に変換し、それを使って自動的に問題を解決するというものでした。このアプローチは、以下の2つの大きなアイデアに基づいていました：

* 知識表現
* 推論

## 知識表現

Symbolic AIの重要な概念の一つは**知識**です。知識を*情報*や*データ*と区別することが重要です。例えば、本は知識を含んでいると言えます。なぜなら、本を学ぶことで専門家になることができるからです。しかし、本が含んでいるものは実際には*データ*と呼ばれます。本を読み、このデータを私たちの世界モデルに統合することで、このデータを知識に変換します。

> ✅ **知識**とは、私たちの頭の中に含まれ、世界の理解を表すものです。それは、受け取った情報を私たちの世界のアクティブモデルに統合するアクティブな**学習**プロセスによって得られます。

私たちはしばしば知識を厳密に定義することはありませんが、[DIKWピラミッド](https://en.wikipedia.org/wiki/DIKW_pyramid)を使用して、他の関連する概念と整合させます。それは以下の概念を含んでいます：

* **データ**は、書かれたテキストや話された言葉のように、物理的なメディアに表現されたものです。データは人間から独立して存在し、人々の間で渡されることができます。
* **情報**は、私たちが頭の中でデータを解釈する方法です。例えば、「コンピュータ」という言葉を聞くと、私たちはそれが何であるかを理解しています。
* **知識**は、私たちの世界モデルに統合された情報です。例えば、コンピュータが何であるかを学ぶと、私たちはそれがどのように機能するのか、どれくらいのコストがかかるのか、何に使えるのかについての考えを持ち始めます。この相互に関連した概念のネットワークが私たちの知識を形成します。
* **知恵**は、世界に対する理解のさらなるレベルであり、*メタ知識*を表します。つまり、知識がどのように、またはいつ使用されるべきかに関する概念です。

<img src="images/DIKW_Pyramid.png" width="30%"/>

*画像 [Wikipediaから](https://commons.wikimedia.org/w/index.php?curid=37705247)、著作権者 Longlivetheux - 自作、CC BY-SA 4.0*

したがって、**知識表現**の問題は、データの形でコンピュータ内に知識を表現する効果的な方法を見つけることです。これを自動的に利用できるようにするためです。これはスペクトルとして見ることができます：

![知識表現のスペクトル](../../../../translated_images/knowledge-spectrum.b60df631852c0217e941485b79c9eee40ebd574f15f18609cec5758fcb384bf3.ja.png)

> 画像 by [Dmitry Soshnikov](http://soshnikov.com)

* 左側には、コンピュータによって効果的に使用できる非常に単純なタイプの知識表現があります。最も単純なものはアルゴリズム的で、知識がコンピュータプログラムによって表現されます。しかし、これは知識を表現する最良の方法ではありません。なぜなら、柔軟性がないからです。私たちの頭の中の知識はしばしば非アルゴリズム的です。
* 右側には、自然なテキストのような表現があります。これは最も強力ですが、自動推論には使用できません。

> ✅ 自分の頭の中でどのように知識を表現し、それをノートに変換しているかを考えてみてください。保持を助けるためにうまく機能する特定のフォーマットはありますか？

## コンピュータの知識表現の分類

さまざまなコンピュータの知識表現方法を以下のカテゴリに分類できます：

* **ネットワーク表現**は、私たちの頭の中に相互に関連する概念のネットワークがあるという事実に基づいています。同じネットワークをコンピュータ内のグラフとして再現しようとすることができます - いわゆる**セマンティックネットワーク**です。

1. **オブジェクト-属性-値の三つ組**または**属性-値ペア**。グラフはノードとエッジのリストとしてコンピュータ内で表現できるため、オブジェクト、属性、値を含む三つ組のリストでセマンティックネットワークを表現できます。例えば、プログラミング言語に関する以下の三つ組を構築します：

オブジェクト | 属性 | 値
-------|-----------|------
Python | は | 型なし言語
Python | 発明者 | Guido van Rossum
Python | ブロック構文 | インデント
型なし言語 | ない | 型定義

> ✅ 他のタイプの知識を表現するために三つ組がどのように使用できるか考えてみてください。

2. **階層的表現**は、私たちがしばしば頭の中でオブジェクトの階層を作成するという事実を強調します。例えば、私たちはカナリアが鳥であり、すべての鳥には翼があることを知っています。また、カナリアが通常どのような色をしているか、飛行速度についての考えも持っています。

   - **フレーム表現**は、各オブジェクトまたはオブジェクトのクラスを**フレーム**として表現し、**スロット**を含みます。スロットにはデフォルト値、値の制約、またはスロットの値を取得するために呼び出されるストアドプロシージャがあります。すべてのフレームは、オブジェクト指向プログラミング言語のオブジェクト階層に似た階層を形成します。
   - **シナリオ**は、時間の経過に伴って展開される複雑な状況を表現する特別な種類のフレームです。

**Python**

スロット | 値 | デフォルト値 | インターバル |
-----|-------|---------------|----------|
名前 | Python | | |
は | 型なし言語 | | |
変数ケース | | CamelCase | |
プログラムの長さ | | | 5-5000行 |
ブロック構文 | インデント | | |

3. **手続き的表現**は、特定の条件が発生したときに実行できるアクションのリストによって知識を表現することに基づいています。
   - 生産ルールは、結論を引き出すためのif-thenステートメントです。例えば、医者は「**もし**患者が高熱を持っている**または**血液検査でC反応性蛋白が高い**ならば**、炎症がある」といったルールを持つことができます。条件の一つに出会った場合、炎症についての結論を出し、それをさらに推論に使用できます。
   - アルゴリズムは、手続き的表現の別の形と見なすことができますが、知識ベースのシステムではほとんど直接使用されることはありません。

4. **論理**は、元々アリストテレスによって普遍的な人間の知識を表現する方法として提案されました。
   - 数学的理論としての述語論理は計算可能性が高すぎるため、通常はHorn節のようなその一部が使用されます。これはPrologで使用されます。
   - 記述論理は、オブジェクトの階層を表現し、推論するために使用される論理システムのファミリーです。

## エキスパートシステム

Symbolic AIの初期の成功の一つは、いわゆる**エキスパートシステム**でした。これは、特定の問題領域で専門家として機能するように設計されたコンピュータシステムです。これらは、1人または複数の人間専門家から抽出された**知識ベース**に基づいており、その上で何らかの推論を行う**推論エンジン**を含んでいます。

![人間のアーキテクチャ](../../../../translated_images/arch-human.5d4d35f1bba3ab1cdfda96af2f10b89574eb31e9796d0e3011cd9beda1c35112.ja.png) | ![知識ベースシステム](../../../../translated_images/arch-kbs.3ec5c150b09fa8dadc2beb0931a4983c9e2b03913a89eebcc103b5bb841b0212.ja.png)
---------------------------------------------|------------------------------------------------
人間の神経系の簡略化された構造 | 知識ベースシステムのアーキテクチャ

エキスパートシステムは、人間の推論システムのように構築されており、**短期記憶**と**長期記憶**を含んでいます。同様に、知識ベースシステムでは以下のコンポーネントを区別します：

* **問題メモリ**：現在解決されている問題に関する知識を含みます。すなわち、患者の体温や血圧、炎症があるかどうかなどです。この知識は**静的知識**とも呼ばれ、現在問題について知っていることのスナップショットを含みます - いわゆる*問題状態*です。
* **知識ベース**：問題領域に関する長期的な知識を表します。これは人間の専門家から手動で抽出され、相談ごとに変わることはありません。これは、ある問題状態から別の問題状態へと移動することを可能にするため、**動的知識**とも呼ばれます。
* **推論エンジン**：問題状態空間での検索全体のプロセスを調整し、必要に応じてユーザーに質問をします。また、各状態に適用されるべき正しいルールを見つける役割も担います。

例として、動物の物理的特性に基づいて動物を特定するエキスパートシステムを考えてみましょう：

![AND-ORツリー](../../../../translated_images/AND-OR-Tree.5592d2c70187f283703c8e9c0d69d6a786eb370f4ace67f9a7aae5ada3d260b0.ja.png)

> 画像 by [Dmitry Soshnikov](http://soshnikov.com)

この図は**AND-ORツリー**と呼ばれ、一連の生産ルールのグラフィカルな表現です。知識を専門家から抽出する最初の段階では、ツリーを描くことが有用です。コンピュータ内に知識を表現するためには、ルールを使用する方が便利です：

```
IF the animal eats meat
OR (animal has sharp teeth
    AND animal has claws
    AND animal has forward-looking eyes
) 
THEN the animal is a carnivore
```

ルールの左側にある各条件とアクションは本質的にオブジェクト-属性-値（OAV）三つ組です。**作業メモリ**には、現在解決されている問題に対応するOAV三つ組のセットが含まれています。**ルールエンジン**は、条件が満たされているルールを探し、それを適用して作業メモリに別の三つ組を追加します。

> ✅ 好きなトピックについて自分のAND-ORツリーを書いてみてください！

### 前向き推論と後ろ向き推論

上記のプロセスは**前向き推論**と呼ばれます。これは、作業メモリに利用可能な問題に関する初期データから始まり、次の推論ループを実行します：

1. ターゲット属性が作業メモリに存在する場合 - 停止し、結果を提供します
2. 現在満たされている条件を持つすべてのルールを探します - ルールの**競合セット**を取得します。
3. **競合解決**を実行します - このステップで実行される1つのルールを選択します。競合解決戦略にはいくつかの異なる方法があります：
   - 知識ベースで最初に適用可能なルールを選択する
   - ランダムなルールを選択する
   - より*具体的な*ルールを選択する、つまり「左側」（LHS）で最も多くの条件を満たすルールを選択する
4. 選択したルールを適用し、問題状態に新しい知識を挿入します
5. ステップ1から繰り返します。

しかし、場合によっては、問題に関する知識が空である状態から始め、結論に至るのを助ける質問をすることが望ましい場合があります。例えば、医療診断を行う際には、通常、患者を診断する前にすべての医療分析を事前に行うことはありません。むしろ、決定を下す必要があるときに分析を行いたいと考えています。

このプロセスは**後ろ向き推論**を使用してモデル化できます。これは**目標**によって駆動されます - 私たちが見つけようとしている属性値です：

1. 目標の値を与えることができるすべてのルールを選択します（つまり、目標が右側（RHS）にあるルール） - 競合セット
2. この属性に対するルールがない場合、またはユーザーから値を尋ねるべきだというルールがある場合 - それを尋ねます。そうでなければ：
3. 競合解決戦略を使用して、*仮説*として使用する1つのルールを選択します - それを証明しようとします
4. ルールのLHSにあるすべての属性について、このプロセスを再帰的に繰り返し、目標として証明しようとします
5. 途中でプロセスが失敗した場合 - ステップ3で別のルールを使用します。

> ✅ 前向き推論がより適切な状況はどのようなものですか？後ろ向き推論はどうでしょうか？

### エキスパートシステムの実装

エキスパートシステムは、さまざまなツールを使用して実装できます：

* 高水準プログラミング言語で直接プログラムすること。これは最良のアイデアではありません。なぜなら、知識ベースシステムの主な利点は、知識が推論から分離されていることであり、問題領域の専門家が推論プロセスの詳細を理解することなくルールを書くことができるべきだからです。
* **エキスパートシステムシェル**を使用すること、すなわち、知識を知識表現言語を使用して埋め込むために特別に設計されたシステムです。

## ✍️ 演習：動物推論

[Animals.ipynb](https://github.com/microsoft/AI-For-Beginners/blob/main/lessons/2-Symbolic/Animals.ipynb)を参照して、前向き推論と後ろ向き推論のエキスパートシステムを実装する例を見てみましょう。

> **注**：この例は非常にシンプルで、エキスパートシステムがどのように見えるかのアイデアを示すだけです。このようなシステムを作成し始めると、200以上のルールに達するまで、システムからの*知的*な振る舞いに気づくことはほとんどありません。ある時点で、ルールがあまりにも複雑になり、すべてを心に留めておくことができなくなります。その時点で、なぜシステムが特定の決定を下したのか疑問に思い始めるかもしれません。しかし、知識ベースシステムの重要な特性は、どの決定がどのように行われたかを

**免責事項**:  
この文書は、機械ベースのAI翻訳サービスを使用して翻訳されました。正確性を追求していますが、自動翻訳にはエラーや不正確さが含まれる可能性があることをご承知おきください。元の文書は、その母国語での権威ある情報源と見なされるべきです。重要な情報については、専門の人間翻訳を推奨します。この翻訳の使用に起因する誤解や誤訳について、当社は一切責任を負いません。