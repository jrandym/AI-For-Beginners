# 名前付きエンティティ認識

これまで、私たちは主に1つのNLPタスク、すなわち分類に集中してきました。しかし、ニューラルネットワークを使用して達成できる他のNLPタスクも存在します。その中の1つが**[名前付きエンティティ認識](https://wikipedia.org/wiki/Named-entity_recognition)**（NER）であり、これはテキスト内の特定のエンティティ、たとえば場所、人名、日付・時間の範囲、化学式などを認識することに関係しています。

## [講義前クイズ](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/119)

## NERの使用例

たとえば、Amazon AlexaやGoogle Assistantのような自然言語チャットボットを開発したいとします。インテリジェントなチャットボットが機能する方法は、入力文に対してテキスト分類を行うことでユーザーが求めていることを*理解*することです。この分類の結果は、チャットボットが何をすべきかを決定する**意図**と呼ばれます。

<img alt="Bot NER" src="images/bot-ner.png" width="50%"/>

> 著者による画像

しかし、ユーザーはフレーズの一部としていくつかのパラメータを提供する場合があります。たとえば、天気を尋ねるとき、彼女は場所や日付を指定するかもしれません。ボットはこれらのエンティティを理解し、アクションを実行する前にパラメータスロットを適切に埋める必要があります。これがまさにNERの出番です。

> ✅ 別の例としては、[科学的な医療論文の分析](https://soshnikov.com/science/analyzing-medical-papers-with-azure-and-text-analytics-for-health/)が挙げられます。私たちが探すべき主要なことの1つは、病気や医療物質などの特定の医療用語です。少数の病気は部分文字列検索を使用して抽出できるかもしれませんが、化学化合物や薬の名前などのより複雑なエンティティには、より複雑なアプローチが必要です。

## トークン分類としてのNER

NERモデルは本質的に**トークン分類モデル**です。なぜなら、各入力トークンがエンティティに属するかどうかを判断する必要があり、属する場合はどのエンティティクラスに属するかを決定する必要があるからです。

次の論文のタイトルを考えてみましょう：

**三尖弁逆流**と**炭酸リチウム**の**毒性**についての新生児。

ここでのエンティティは次の通りです：

* 三尖弁逆流は病気です (`DIS`)
* 炭酸リチウムは化学物質です (`CHEM`)
* 毒性も病気です (`DIS`)

1つのエンティティが複数のトークンにまたがることに注意してください。そして、この場合のように、2つの連続したエンティティを区別する必要があります。したがって、各エンティティに対して2つのクラスを使用するのが一般的です。1つはエンティティの最初のトークンを指定し（通常は`B-`プレフィックスが使用されます、つまり**b**eginning）、もう1つはエンティティの続きです（`I-`、つまり**i**nner token）。また、`O`をすべての**o**therトークンを表すクラスとして使用します。このようなトークンタグ付けは、[BIOタグ付け](https://en.wikipedia.org/wiki/Inside%E2%80%93outside%E2%80%93beginning_(tagging))（またはIOB）と呼ばれます。タグ付けされると、私たちのタイトルは次のようになります：

トークン | タグ
------|-----
三尖弁 | B-DIS
逆流 | I-DIS
と | O
炭酸 | B-CHEM
リチウム | I-CHEM
毒性 | B-DIS
について | O
の | O
新生児 | O
。 | O

トークンとクラスの間に1対1の対応を構築する必要があるため、この図から右端の**多対多**ニューラルネットワークモデルをトレーニングすることができます：

![一般的な再帰的ニューラルネットワークのパターンを示す画像。](../../../../../translated_images/unreasonable-effectiveness-of-rnn.541ead816778f42dce6c42d8a56c184729aa2378d059b851be4ce12b993033df.ja.jpg)

> *この画像は[このブログ記事](http://karpathy.github.io/2015/05/21/rnn-effectiveness/)からのものです。[Andrej Karpathy](http://karpathy.github.io/)によるものです。NERトークン分類モデルは、この画像の右端のネットワークアーキテクチャに対応しています。*

## NERモデルのトレーニング

NERモデルは本質的にトークン分類モデルであるため、このタスクにはすでに知っているRNNを使用できます。この場合、再帰ネットワークの各ブロックはトークンIDを返します。以下の例のノートブックでは、トークン分類のためのLSTMをトレーニングする方法を示しています。

## ✍️ 例のノートブック：NER

以下のノートブックで学習を続けてください：

* [TensorFlowを使用したNER](../../../../../lessons/5-NLP/19-NER/NER-TF.ipynb)

## 結論

NERモデルは**トークン分類モデル**であり、トークン分類を実行するために使用できます。これは、場所、名前、日付など、テキスト内の特定のエンティティを認識するのに役立つ非常に一般的なタスクです。

## 🚀 チャレンジ

以下のリンクされた課題を完了して、医療用語のための名前付きエンティティ認識モデルをトレーニングし、その後異なるデータセットで試してみてください。

## [講義後クイズ](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/219)

## レビューと自己学習

ブログ[再帰的ニューラルネットワークの不合理な効果](http://karpathy.github.io/2015/05/21/rnn-effectiveness/)を読み、その記事のさらなる読み物セクションに従って知識を深めてください。

## [課題](lab/README.md)

このレッスンの課題では、医療エンティティ認識モデルをトレーニングする必要があります。このレッスンで説明されているLSTMモデルのトレーニングから始め、BERTトランスフォーマーモデルの使用に進むことができます。すべての詳細を確認するには、[指示を読んでください](lab/README.md)。

**免責事項**:  
この文書は、機械翻訳AIサービスを使用して翻訳されています。正確性を追求していますが、自動翻訳には誤りや不正確さが含まれる可能性があることにご留意ください。原文の母国語の文書が権威ある情報源と見なされるべきです。重要な情報については、専門の人間翻訳をお勧めします。この翻訳の使用に起因する誤解や誤訳について、当社は責任を負いません。