# Представление знаний и экспертные системы

![Сводка содержимого Символического ИИ](../../../../translated_images/ai-symbolic.715a30cb610411a6964d2e2f23f24364cb338a07cb4844c1f97084d366e586c3.ru.png)

> Скетчнот от [Томоми Имура](https://twitter.com/girlie_mac)

Поиск искусственного интеллекта основан на стремлении к знанию, чтобы осознать мир так же, как это делают люди. Но как можно это осуществить?

## [Викторина перед лекцией](https://red-field-0a6ddfd03.1.azurestaticapps.net/quiz/102)

В ранние дни ИИ подход «сверху вниз» к созданию интеллектуальных систем (обсуждавшийся на предыдущем уроке) был популярен. Идея заключалась в том, чтобы извлечь знания из людей в какую-то машиночитаемую форму и затем использовать их для автоматического решения задач. Этот подход основывался на двух основных идеях:

* Представление знаний
* Рассуждение

## Представление знаний

Одним из важных понятий в Символическом ИИ является **знание**. Важно различать знание и *информацию* или *данные*. Например, можно сказать, что книги содержат знания, потому что, изучая книги, можно стать экспертом. Однако то, что содержится в книгах, на самом деле называется *данными*, и, читая книги и интегрируя эти данные в нашу модель мира, мы преобразуем эти данные в знания.

> ✅ **Знание** — это то, что содержится в нашей голове и представляет собой наше понимание мира. Оно приобретается в результате активного **обучения**, которое интегрирует кусочки информации, которые мы получаем, в нашу активную модель мира.

Чаще всего мы не строго определяем знание, но согласуем его с другими связанными концепциями, используя [Пирамиду DIKW](https://en.wikipedia.org/wiki/DIKW_pyramid). Она включает в себя следующие концепции:

* **Данные** — это то, что представлено в физических носителях, таких как написанный текст или произнесенные слова. Данные существуют независимо от людей и могут передаваться между людьми.
* **Информация** — это то, как мы интерпретируем данные в своей голове. Например, когда мы слышим слово *компьютер*, у нас есть некоторое понимание того, что это.
* **Знание** — это информация, интегрированная в нашу модель мира. Например, как только мы узнаем, что такое компьютер, у нас начинают возникать идеи о том, как он работает, сколько он стоит и для чего его можно использовать. Эта сеть взаимосвязанных концепций формирует наши знания.
* **Мудрость** — это еще один уровень нашего понимания мира, и она представляет собой *мета-знание*, т.е. некоторое представление о том, как и когда знания должны использоваться.

<img src="images/DIKW_Pyramid.png" width="30%"/>

*Изображение [из Википедии](https://commons.wikimedia.org/w/index.php?curid=37705247), автор Longlivetheux - собственная работа, CC BY-SA 4.0*

Таким образом, проблема **представления знаний** заключается в поиске эффективного способа представления знаний внутри компьютера в форме данных, чтобы сделать их автоматически доступными. Это можно рассматривать как спектр:

![Спектр представления знаний](../../../../translated_images/knowledge-spectrum.b60df631852c0217e941485b79c9eee40ebd574f15f18609cec5758fcb384bf3.ru.png)

> Изображение от [Дмитрия Сошникова](http://soshnikov.com)

* Слева находятся очень простые типы представлений знаний, которые могут эффективно использоваться компьютерами. Самый простой — алгоритмический, когда знание представлено компьютерной программой. Однако это не лучший способ представления знаний, поскольку он не гибкий. Знания в нашей голове часто не алгоритмичны.
* Справа находятся такие представления, как естественный текст. Это самое мощное, но не может быть использовано для автоматического рассуждения.

> ✅ Подумайте минуту о том, как вы представляете знания в своей голове и переводите их в заметки. Есть ли какой-то конкретный формат, который хорошо помогает вам в запоминании?

## Классификация представлений знаний в компьютере

Мы можем классифицировать различные методы представления знаний в компьютере по следующим категориям:

* **Сетевые представления** основаны на том факте, что у нас есть сеть взаимосвязанных концепций в нашей голове. Мы можем попытаться воспроизвести такие же сети в виде графа внутри компьютера — так называемая **семантическая сеть**.

1. **Триплеты объект-атрибут-значение** или **пары атрибут-значение**. Поскольку граф может быть представлен внутри компьютера в виде списка узлов и рёбер, мы можем представить семантическую сеть в виде списка триплетов, содержащих объекты, атрибуты и значения. Например, мы строим следующие триплеты о языках программирования:

Объект | Атрибут | Значение
-------|-----------|------
Python | является | Непривязанным-Языком
Python | изобретён | Гвидо ван Россумом
Python | синтаксис-блоков | отступы
Непривязанный-Язык | не имеет | определений типов

> ✅ Подумайте, как триплеты могут быть использованы для представления других типов знаний.

2. **Иерархические представления** подчеркивают тот факт, что мы часто создаем иерархию объектов в своей голове. Например, мы знаем, что канарейка — это птица, и все птицы имеют крылья. У нас также есть некоторое представление о том, какого цвета обычно канарейка, и какова их скорость полета.

   - **Представление рамок** основано на представлении каждого объекта или класса объектов в виде **рамки**, которая содержит **слоты**. Слоты имеют возможные значения по умолчанию, ограничения значений или хранимые процедуры, которые могут быть вызваны для получения значения слота. Все рамки формируют иерархию, аналогичную иерархии объектов в языках программирования с объектно-ориентированной парадигмой.
   - **Сценарии** — это особый вид рамок, которые представляют сложные ситуации, которые могут развиваться во времени.

**Python**

Слот | Значение | Значение по умолчанию | Интервал |
-----|-------|---------------|----------|
Имя | Python | | |
Является | Непривязанным-Языком | | |
Регистр переменной | | CamelCase | |
Длина программы | | | 5-5000 строк |
Синтаксис блока | Отступ | | |

3. **Процедурные представления** основаны на представлении знаний в виде списка действий, которые могут быть выполнены, когда возникает определенное условие.
   - Производственные правила — это условия «если-то», которые позволяют нам делать выводы. Например, врач может иметь правило, согласно которому **ЕСЛИ** у пациента высокая температура **ИЛИ** высокий уровень С-реактивного белка в анализе крови **ТО** у него воспаление. Как только мы сталкиваемся с одним из условий, мы можем сделать вывод о воспалении, а затем использовать его в дальнейшем рассуждении.
   - Алгоритмы можно считать другой формой процедурного представления, хотя их почти никогда не используют напрямую в системах, основанных на знаниях.

4. **Логика** изначально была предложена Аристотелем как способ представления универсальных человеческих знаний.
   - Логика предикатов как математическая теория слишком богата, чтобы быть вычисляемой, поэтому обычно используется какой-то её подмножество, например, Horn-клаузулы, используемые в Prolog.
   - Описательная логика — это семейство логических систем, используемых для представления и рассуждения о иерархиях объектов распределенных представлений знаний, таких как *семантическая паутина*.

## Экспертные системы

Одним из ранних успехов символического ИИ стали так называемые **экспертные системы** — компьютерные системы, разработанные для того, чтобы действовать как эксперт в какой-то ограниченной предметной области. Они основывались на **базе знаний**, извлеченной от одного или нескольких человеческих экспертов, и содержали **движок вывода**, который выполнял некоторые рассуждения на её основе.

![Человеческая архитектура](../../../../translated_images/arch-human.5d4d35f1bba3ab1cdfda96af2f10b89574eb31e9796d0e3011cd9beda1c35112.ru.png) | ![Система на основе знаний](../../../../translated_images/arch-kbs.3ec5c150b09fa8dadc2beb0931a4983c9e2b03913a89eebcc103b5bb841b0212.ru.png)
---------------------------------------------|------------------------------------------------
Упрощенная структура человеческой нейронной системы | Архитектура системы на основе знаний

Экспертные системы строятся подобно человеческой системе рассуждений, которая содержит **краткосрочную память** и **долгосрочную память**. Аналогично в системах на основе знаний мы различаем следующие компоненты:

* **Память о проблеме**: содержит знания о проблеме, которая в данный момент решается, т.е. температура или давление крови пациента, есть ли у него воспаление и т.д. Эти знания также называются **статическими знаниями**, потому что они содержат снимок того, что мы в данный момент знаем о проблеме — так называемое *состояние проблемы*.
* **База знаний**: представляет собой долгосрочные знания о предметной области. Она извлекается вручную от человеческих экспертов и не меняется от консультации к консультации. Поскольку она позволяет нам перемещаться от одного состояния проблемы к другому, её также называют **динамическими знаниями**.
* **Движок вывода**: организует весь процесс поиска в пространстве состояний проблемы, задавая вопросы пользователю при необходимости. Он также отвечает за нахождение правильных правил, которые должны быть применены к каждому состоянию.

В качестве примера рассмотрим следующую экспертную систему для определения животного по его физическим характеристикам:

![AND-OR Дерево](../../../../translated_images/AND-OR-Tree.5592d2c70187f283703c8e9c0d69d6a786eb370f4ace67f9a7aae5ada3d260b0.ru.png)

> Изображение от [Дмитрия Сошникова](http://soshnikov.com)

Эта диаграмма называется **AND-OR деревом**, и это графическое представление набора производственных правил. Построение дерева полезно в начале извлечения знаний от эксперта. Чтобы представить знания внутри компьютера, удобнее использовать правила:

```
IF the animal eats meat
OR (animal has sharp teeth
    AND animal has claws
    AND animal has forward-looking eyes
) 
THEN the animal is a carnivore
```

Вы можете заметить, что каждое условие на левой стороне правила и действие по сути являются триплетами объект-атрибут-значение (OAV). **Рабочая память** содержит набор триплетов OAV, которые соответствуют решаемой в данный момент проблеме. **Движок правил** ищет правила, для которых удовлетворено условие, и применяет их, добавляя еще один триплет в рабочую память.

> ✅ Нарисуйте своё собственное AND-OR дерево на тему, которая вам интересна!

### Прямое и обратное рассуждение

Процесс, описанный выше, называется **прямым рассуждением**. Он начинается с некоторых начальных данных о проблеме, доступных в рабочей памяти, и затем выполняет следующий цикл рассуждений:

1. Если целевой атрибут присутствует в рабочей памяти — остановитесь и дайте результат
2. Ищите все правила, чье условие в данный момент выполнено — получите **набор конфликтов** правил.
3. Выполните **разрешение конфликта** — выберите одно правило, которое будет выполнено на этом шаге. Могут быть различные стратегии разрешения конфликта:
   - Выберите первое применимое правило в базе знаний
   - Выберите случайное правило
   - Выберите *более специфичное* правило, т.е. то, которое удовлетворяет наибольшему количеству условий в «левой части» (LHS)
4. Примените выбранное правило и вставьте новый кусок знания в состояние проблемы
5. Повторите с шага 1.

Однако в некоторых случаях мы можем захотеть начать с пустого знания о проблеме и задавать вопросы, которые помогут нам прийти к заключению. Например, при проведении медицинской диагностики мы обычно не выполняем все медицинские анализы заранее, прежде чем начать диагностику пациента. Скорее, мы хотим проводить анализы, когда необходимо принять решение.

Этот процесс можно смоделировать с помощью **обратного рассуждения**. Он управляется **целью** — значением атрибута, который мы ищем:

1. Выберите все правила, которые могут дать нам значение цели (т.е. с целью на правой стороне (RHS)) — набор конфликтов
1. Если для этого атрибута нет правил или есть правило, которое говорит, что мы должны спросить значение у пользователя — спросите его, иначе:
1. Используйте стратегию разрешения конфликта, чтобы выбрать одно правило, которое мы будем использовать в качестве *гипотезы* — мы попытаемся его доказать
1. Повторяйте процесс для всех атрибутов в LHS правила, пытаясь доказать их как цели
1. Если в какой-то момент процесс не удается — используйте другое правило на шаге 3.

> ✅ В каких ситуациях прямое рассуждение более уместно? А как насчет обратного рассуждения?

### Реализация экспертных систем

Экспертные системы могут быть реализованы с помощью различных инструментов:

* Программируя их напрямую на каком-либо высокоуровневом языке программирования. Это не лучшая идея, потому что главное преимущество системы на основе знаний заключается в том, что знания отделены от вывода, и потенциально эксперт в предметной области должен иметь возможность писать правила, не понимая деталей процесса вывода.
* Используя **оболочку экспертных систем**, т.е. систему, специально разработанную для заполнения знаниями с использованием какого-либо языка представления знаний.

## ✍️ Упражнение: Вывод о животных

Смотрите [Animals.ipynb](https://github.com/microsoft/AI-For-Beginners/blob/main/lessons/2-Symbolic/Animals.ipynb) для примера реализации экспертной системы с прямым и обратным выводом.

> **Примечание**: Этот пример довольно прост и лишь дает представление о том, как выглядит экспертная система. Как только вы начнете создавать такую систему, вы заметите некоторое *интеллектуальное* поведение только тогда, когда достигнете определенного количества правил, около 200+. В какой-то момент правила становятся слишком сложными, чтобы держать все их в голове, и в этот момент вы можете начать задаваться вопросом, почему система принимает те или иные решения. Однако важной характеристикой систем на основе знаний является то, что вы всегда можете *объяснить*, как были приняты те или иные решения.

## Онтологии и Семантическая паутина

В конце 20 века была инициатива использовать представление знаний для аннотирования интернет-ресурсов, чтобы можно было находить ресурсы, которые соответствуют очень специфическим запросам. Это движение назвали **Семантическая паутина**, и оно основывалось на нескольких концепциях:

- Специальное представление знаний на основе **[логик описания](https://en.wikipedia.org/wiki/Description_logic)** (DL). Оно похоже на представление знаний в виде рамок, потому что строит иерархию объектов с свойствами, но имеет формальную логическую семантику и вывод. Существует целое семейство DL, которые балансируют между выразительностью и алгоритмической сложностью вывода.
- Распределенное представление знаний, где все концепции представлены глобальным URI-идентификатором, что позволяет создавать иерархии знаний, охватывающие интернет.
- Семейство языков на основе XML для описания знаний: RDF (Рамки описания ресурсов), RDFS (Схема RDF), OWL (Язык веб-онтологий).

Основной концепцией в Семантической паутине является концепция **Онтологии**. Она относится к явной спецификации предметной области с использованием некоторого формального представления знаний. Самая простая онтология может быть просто иерархией объектов в предметной области, но более сложные онтологии будут включать правила, которые могут использоваться для вывода.

В семантической паутине все представления основаны на триплетах. Каждый объект и каждое отношение уникально идентифицированы URI. Например, если мы хотим заявить о том, что этот Учебный план ИИ был разработан Дмитрием Сошниковым 1 января 2022 года — вот триплеты, которые мы можем использовать:

<img src="images/triplet.png" width="30%"/>

```
http://github.com/microsoft/ai-for-beginners http://www.example.com/terms/creation-date “Jan 13, 2007”
http://github.com/microsoft/ai-for-beginners http://purl.org/dc/elements/1.1/creator http://soshnikov.com
```

> ✅ Здесь `http://www.example.com/terms/creation-date` and `http://purl.org/dc/elements/1.1/creator` — это некоторые известные и универсально принятые URI для выражения концепций *создатель* и *дата создания*.

В более сложном случае, если мы хотим определить список создателей, мы можем использовать некоторые структуры данных, определенные в RDF.

<img src="images/triplet-complex.png" width="40%"/>

> Диаграммы выше от [Дмитрия Сошникова](http://soshnikov.com)

Прогресс в создании Семантической паутины был несколько замедлен успехом поисковых систем и технологий обработки естественного языка, которые позволяют извлекать структурированные данные из текста. Однако в некоторых областях все еще ведутся значительные усилия по поддержанию онтологий и баз знаний. Несколько проектов, которые стоит отметить:

* [WikiData](https://wikidata.org/) — это коллекция машинно-читаемых баз знаний, связанных с Википедией. Большинство данных извлекаются из *Инфобоксов* Википедии, кусочков структурированного контента на страницах Википедии. Вы можете [запрашивать](https://query.wikidata.org/) wikidata в SPARQL, специальном языке запросов для Семантической паутины. Вот пример запроса, который отображает самые популярные цвета глаз среди людей:

```sparql
#defaultView:BubbleChart
SELECT ?eyeColorLabel (COUNT(?human) AS ?count)
WHERE
{
  ?human wdt:P31 wd:Q5.       # human instance-of homo sapiens
  ?human wdt:P1340 ?eyeColor. # human eye-color ?eyeColor
  SERVICE wikibase:label { bd:serviceParam wikibase:language "en". }
}
GROUP BY ?eyeColorLabel
```

* [DBpedia](https://www.dbpedia.org/) — это еще одна инициатива, аналогичная WikiData.

> ✅ Если вы хотите поэкспериментировать с созданием своих собственных онтологий или открыть существующие, существует отличный визуальный редактор онтологий под названием [Protégé](https://protege.st

**Отказ от ответственности**:  
Этот документ был переведен с использованием услуг машинного перевода на основе ИИ. Хотя мы стремимся к точности, пожалуйста, имейте в виду, что автоматические переводы могут содержать ошибки или неточности. Оригинальный документ на его родном языке следует считать авторитетным источником. Для критически важной информации рекомендуется профессиональный человеческий перевод. Мы не несем ответственности за любые недоразумения или неправильные толкования, возникающие в результате использования этого перевода.